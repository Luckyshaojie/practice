<div class="content-one">
    <ul class="mui-table-view">
        <li class="mui-table-view-cell mui-media">
            <div class="mui-row">
                <div class="mui-col-xs-2">
                    <img class="mui-media-object mui-pull-left" src="img/headpic1.png">
                </div>
                <div class="mui-col-xs-10">
                    <span>与美丽同行社区</span>
                    <div>
                        <button>发帖</button>
                        <button>申请加入</button>
                    </div>
                </div>
            </div>
        </li>
    </ul>
    <ul id="listUl" class="mui-table-view">
        <li class="mui-table-view-cell mui-media">
            <a href="javascript:;">
                <div class="mui-row">
                    <div class="mui-col-xs-2">
                        <img class="mui-media-object mui-pull-left" src="img/headpic1.png">
                    </div>
                    <div class="mui-col-xs-10 pl-content">
                        <div class="mui-media-body">
                            陈蓉
                            <p class='no-tital-p'>现在临床医学科学对失眠的认识存在局限性，但是，临床医学家们已经开始根据临床研究，
                                给失眠进行定义，2012年中华医学会神经病学分会.失眠进行定义，2012年中华医学会神经病学失眠进行定义，
                                2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                                失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                            </p>
                        </div>
                        <p class="all-content">全部</p>
                        <img src="img/shequBG.png" width="100%">
                        <div class="positon-p">
                            <span>1小时前</span>
                            <span class="mui-icon-extra mui-icon-extra-comment p-pos"></span>
                            <div class="mui-row pop-zan">
                                <div class="mui-col-xs-6 dianzan">
                                    <span class="mui-icon-extra mui-icon-extra-heart"></span>
                                    <span>赞</span>
                                </div>
                                <div class="mui-col-xs-6 pinglun">
                                    <span class="mui-icon mui-icon-chatboxes"></span>
                                    <span>评论</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </a>
        </li>
        <li class="mui-table-view-cell mui-media">
            <a href="javascript:;">
                <div class="mui-row">
                    <div class="mui-col-xs-2">
                        <img class="mui-media-object mui-pull-left" src="img/headpic1.png">
                    </div>
                    <div class="mui-col-xs-10">
                        <div class="mui-media-body">
                            陈蓉
                            <p class='no-tital-p'>现在临床医学科学对失眠的认识存在局限性，但是，临床医学家们已经开始根据临床研究，
                                给失眠进行定义，2012年中华医学会神经病学分会.失眠进行定义，2012年中华医学会神经病学失眠进行定义，
                                2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                                失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                            </p>
                        </div>
                        <p class="all-content">全部</p>
                        <img src="img/shequBG.png" width="100%">
                        <div class="positon-p">
                            <span>1小时前</span>
                            <span class="mui-icon-extra mui-icon-extra-comment p-pos"></span>
                            <div class="mui-row pop-zan">
                                <div class="mui-col-xs-6 dianzan">
                                    <span class="mui-icon-extra mui-icon-extra-heart"></span>
                                    <span>赞</span>
                                </div>
                                <div class="mui-col-xs-6 pinglun">
                                    <span class="mui-icon mui-icon-chatboxes"></span>
                                    <span>评论</span>
                                </div>
                            </div>
                        </div>
                        <div class="pinglun-bg">
                            <div class="zan-container">
                                <span class="mui-icon-extra mui-icon-extra-heart"></span><span>张医生</span>
                            </div>
                            <ul class="mui-table-view">
                                <li class="mui-table-view-cell">王大夫：说的很好</li>
                                <li class="mui-table-view-cell">王大夫：说的很好</li>
                                <li class="mui-table-view-cell">王大夫：说的很好</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </a>
        </li>
        <li class="mui-table-view-cell mui-media">
            <a href="javascript:;">
                <div class="mui-row">
                    <div class="mui-col-xs-2">
                        <img class="mui-media-object mui-pull-left" src="img/headpic1.png">
                    </div>
                    <div class="mui-col-xs-10">
                        <div class="mui-media-body">
                            陈蓉
                            <p class='no-tital-p'>现在临床医学科学对失眠的认识存在局限性，但是，临床医学家们已经开始根据临床研究，
                                给失眠进行定义，2012年中华医学会神经病学分会.失眠进行定义，2012年中华医学会神经病学失眠进行定义，
                                2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                                失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学失眠进行定义，2012年中华医学会神经病学
                            </p>
                        </div>
                        <p class="all-content">全部</p>
                        <img src="img/shequBG.png" width="100%">
                        <div class="positon-p">
                            <span>1小时前</span>
                            <span class="mui-icon-extra mui-icon-extra-comment p-pos"></span>
                            <div class="mui-row pop-zan">
                                <div class="mui-col-xs-6 dianzan">
                                    <span class="mui-icon-extra mui-icon-extra-heart"></span>
                                    <span>赞</span>
                                </div>
                                <div class="mui-col-xs-6 pinglun">
                                    <span class="mui-icon mui-icon-chatboxes"></span>
                                    <span>评论</span>
                                </div>
                            </div>
                        </div>
                        <div class="pinglun-bg">
                            <div class="zan-container">
                                <span class="mui-icon-extra mui-icon-extra-heart"></span><span>张医生</span>
                            </div>
                            <ul class="mui-table-view">

                            </ul>
                        </div>
                    </div>
                </div>
            </a>
        </li>
    </ul>
</div>
<script>
    /*显示全部和收起*/
    mui("#listUl").on("tap",".all-content",function(){
        if($(this).text() == "全部"){
            $(this).prev().find("p").css("height","auto");
            $(this).text('收起');
        }else {
            $(this).prev().find("p").css("height",128+"px");
            $(this).text('全部');
        }
    })
    /*评论和点赞*/
    mui("#listUl").on('tap',".p-pos",function(){
        $(".pop-zan").not($(this).next()).hide();
        $(this).next().toggle();
    })
    offCanvasInner.addEventListener("scroll",function(){
        $(".pop-zan").hide();
    })
    //	点赞
    mui("#listUl").on("tap",".dianzan",function(){
        $(this).parent().hide();
        var contentContainer = $(this).parent().parent().parent();
        var len = contentContainer.find(".pinglun-bg");
        if(len.length){
            var length = contentContainer.find(".zan-container").children().length;
            if(length>0){
                addZan("刘医生",contentContainer,true);
            }else {
                addZan("刘医生",contentContainer,false);
            }
        }else {
            createPingLunQu(contentContainer);
            addZan("刘医生",contentContainer,false)
            /*var tip = $(this).parent().parent().parent();
             var container = createPingLunQu(tip);
             addZan("刘医生",container);*/
        }

    })
    function createPingLunQu(container){
        var pl = $("<div class='pinglun-bg'><div class='zan-container'></div><ul class='mui-table-view'></ul></div>")
        container.append(pl);
    }
    function addZan(name,container,boolean){
        if(boolean){
            var namespan = $("<span>,"+ name +"</span>")
        }else {
            var namespan = $("<span class='mui-icon-extra mui-icon-extra-heart'></span><span>"+ name +"</span>")
        }
        var ct = container.find(".zan-container");
        ct.append(namespan);
        /*var ct = container.find(".zan-container");
         var length = ct.children().length;
         if(length > 0){
         var namespan = $("<span>,"+ name +"</span>")
         ct.append(namespan);
         }else {
         var namespan = $("<span class='mui-icon-extra mui-icon-extra-heart'></span><span>"+ name +"</span>")
         ct.append(namespan);
         }*/
    }
    //	评论
    mui("#listUl").on("tap",".pinglun",function(){
        $(this).parent().hide();
        nowtip = $(this).parent().parent().parent().find(".pinglun-bg");
        nowcol10 = $(this).parent().parent().parent();
        mask.show();//显示遮罩
        $(".pop-pinglun").css("top",0);
    })
    mui("#send")[0].addEventListener("tap",function(){
        $(".pop-pinglun").css("top",-240+"px");
        mask.close();//显示遮罩
        var text = $(".pop-pinglun").find("textarea").val();
        if(nowtip.length){
            addPingLun("刘医生",text,nowtip);
        }else {
            createPingLunQu(nowcol10);
            var container = nowcol10.find(".pinglun-bg");
            addPingLun("刘医生",text,container);
        }
    })
    function addPingLun(name,content,container){
        /*var length = container.children().length;*/
        var li = $("<li class='mui-table-view-cell'>"+ name +"：" + content + "</li>")
        container.children().eq(1).append(li);
        /*if(length>1){
         container.children().eq(1).append(li);
         }else {
         container.children().eq(0).append(li);
         }*/
    }
</script>